/*

Run this script on:

	Profiles RNS Version 2.12.0

to update its data to:

	Profiles RNS Version 3.0.0

*** You are recommended to back up your database before running this script!

*** You should review each step of this script to ensure that it will not overwrite any customizations you have made to ProfilesRNS.

*** Make sure you run the ProfilesRNS_Upgrade_Schema.sql file before running this file.
   
*/


-- Plugin instance class, this is the class that a Plugin node gets.
INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#PluginInstance', 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type', 'http://www.w3.org/2002/07/owl#Class')

INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#PluginInstance', 'http://www.w3.org/2000/01/rdf-schema#label', 'ProfilesRNS Plugin Instance')

-- Plugin Searchable Data class, this is the class that we use to allow plugin data to be searchable
INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#pluginSearchableData', 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type', 'http://www.w3.org/2002/07/owl#DatatypeProperty')

INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#pluginSearchableData', 'http://www.w3.org/2000/01/rdf-schema#label', 'ProfilesRNS Plugin Searchable Data')

-- PluginInstanceFor is a generic property that links back from a plugin instance to the Person / Group.
-- The link from person to plugin instance is created when the plugin is initialized.
INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#pluginInstanceFor', 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type', 'http://www.w3.org/2002/07/owl#ObjectProperty')

INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#pluginInstanceFor', 'http://www.w3.org/2000/01/rdf-schema#domain', 'http://profiles.catalyst.harvard.edu/ontology/prns#PluginInstance')

INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#pluginInstanceFor', 'http://www.w3.org/2000/01/rdf-schema#label', 'ProfilesRNS Plugin Instance For Person or Group')


-- New class for medialinks
INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#mediaLinks', 'http://www.w3.org/2000/01/rdf-schema#range', 'http://vivoweb.org/ontology/core#URLLink')

INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#mediaLinks', 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type', 'http://www.w3.org/2002/07/owl#ObjectProperty')

INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#mediaLinks', 'http://www.w3.org/2000/01/rdf-schema#label', 'media links')

-- New class for featured content property group
INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupFeaturedContent', 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type', 'http://www.w3.org/2002/07/owl#Class')


INSERT INTO [Ontology.Import].[Triple] (OWL, Graph, Subject, Predicate, Object) 
	VALUES ('PRNS_1.3', 3, 'http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupFeaturedContent', 'http://www.w3.org/2000/01/rdf-schema#label', 'Featured Content')

-- Run procedures to load ontology updates.
EXEC [RDF.Stage].[LoadTriplesFromOntology] @Truncate = 1
EXEC [RDF.Stage].[ProcessTriples]
EXEC [Ontology.].[UpdateDerivedFields]


-- Delete ORNG components
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://orng.info/ontology/orng#Application' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#applicationId'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://orng.info/ontology/orng#Application' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#applicationURL'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://orng.info/ontology/orng#Application' and  NetworkProperty is null and  Property= 'http://www.w3.org/2000/01/rdf-schema#label'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://orng.info/ontology/orng#ApplicationInstance' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#applicationInstanceForPerson'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://orng.info/ontology/orng#ApplicationInstance' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#applicationInstanceOfApplication'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://orng.info/ontology/orng#ApplicationInstance' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#hasApplicationInstanceData'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://orng.info/ontology/orng#ApplicationInstance' and  NetworkProperty is null and  Property= 'http://www.w3.org/2000/01/rdf-schema#label'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://orng.info/ontology/orng#ApplicationInstanceData' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#applicationInstanceDataValue'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://orng.info/ontology/orng#ApplicationInstanceData' and  NetworkProperty is null and  Property= 'http://www.w3.org/2000/01/rdf-schema#label'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://xmlns.com/foaf/0.1/Group' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#hasLinks'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://xmlns.com/foaf/0.1/Group' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#hasSlideShare'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://xmlns.com/foaf/0.1/Group' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#hasTwitter'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://xmlns.com/foaf/0.1/Group' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#hasYouTube'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://xmlns.com/foaf/0.1/Person' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#hasLinks'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://xmlns.com/foaf/0.1/Person' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#hasSlideShare'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://xmlns.com/foaf/0.1/Person' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#hasTwitter'
update [Ontology.].ClassProperty set ViewSecurityGroup = -50, EditSecurityGroup = -50, EditPermissionsSecurityGroup = -50, EditExistingSecurityGroup = -50, EditAddNewSecurityGroup = -50, EditAddExistingSecurityGroup = -50, EditDeleteSecurityGroup = -50 where Class= 'http://xmlns.com/foaf/0.1/Person' and  NetworkProperty is null and  Property= 'http://orng.info/ontology/orng#hasYouTube'


/****************************
*
*   Generic RDF
*
****************************/

insert into [Ontology.].[Namespace] ( URI, Prefix)  values ('http://profiles.catalyst.harvard.edu/ontology/plugins#', 'plugins')

declare @s int
select @s = SortOrder from [Ontology.].PropertyGroup where PropertyGroupURI = 'http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupBibliographic'
update [Ontology.].PropertyGroup set SortOrder = SortOrder + 1 where SortOrder >= @s
insert into [Ontology.].[PropertyGroup] ( PropertyGroupURI, SortOrder, _PropertyGroupLabel)  values ('http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupFeaturedContent', @s, 'Featured Content')

insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup)  select max(ClassPropertyID) + 1, 'http://profiles.catalyst.harvard.edu/ontology/prns#PluginInstance', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#pluginSearchableData', 0, null, 'prns:pluginSearchableData', 'ProfilesRNS Plugin Searchable Data', 1, 0, null, null, null, -40, -40, -40, -40, -40, -40, 0, 0, 1, 0, 0, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup)  select max(ClassPropertyID) + 1, 'http://vivoweb.org/ontology/core#URLLink', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#publicationDate', 0, null, 'prns:publicationDate', 'publication date', 1, 0, null, null, null, -40, -40, -40, -40, -40, -40, 1, 0, 0, 0, 0, -1 from [Ontology.].[ClassProperty]

EXEC [Ontology.].[UpdateDerivedFields]

INSERT [Profile.Module].[GenericRDF.Plugins] ([Name], [EnabledForPerson], [EnabledForGroup], [Label], [PropertyGroupURI], [CustomDisplayModule], [CustomEditModule], [CustomDisplayModuleXML], [CustomEditModuleXML]) VALUES (N'FeaturedPresentations', 1, 1, N'Featured Presentations', N'http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupFeaturedContent', N'FeaturedPresentations', N'EditFeaturedPresentations', NULL, NULL)
INSERT [Profile.Module].[GenericRDF.Plugins] ([Name], [EnabledForPerson], [EnabledForGroup], [Label], [PropertyGroupURI], [CustomDisplayModule], [CustomEditModule], [CustomDisplayModuleXML], [CustomEditModuleXML]) VALUES (N'FeaturedVideos', 1, 1, N'Featured Videos', N'http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupFeaturedContent', N'FeaturedVideos', N'EditFeaturedVideos', NULL, NULL)
INSERT [Profile.Module].[GenericRDF.Plugins] ([Name], [EnabledForPerson], [EnabledForGroup], [Label], [PropertyGroupURI], [CustomDisplayModule], [CustomEditModule], [CustomDisplayModuleXML], [CustomEditModuleXML]) VALUES (N'Twitter', 1, 1, N'Twitter', N'http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupFeaturedContent', N'Twitter', N'EditTwitter', NULL, NULL)

EXEC [Profile.Module].[GenericRDF.AddUpdateOntology] @pluginName='FeaturedPresentations'
EXEC [Profile.Module].[GenericRDF.AddUpdateOntology] @pluginName='FeaturedVideos'
EXEC [Profile.Module].[GenericRDF.AddUpdateOntology] @pluginName='Twitter'


/****************************
*
*   Websites and MediaLinks
*
****************************/
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup)  select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#mediaLinks', 0, null, 'prns:mediaLinks', 'media links', 0, 0, 100, '<Module ID="ApplyXSLT"><ParamList><Param Name="XSLTPath">~/profile/XSLT/MediaLinks.xslt</Param></ParamList></Module>', '<Module ID="CustomEditWebsite"/>', -20, -20, -40, -20, -40, -20, 1, 0, 0.5, 1, 1, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup)  select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://vivoweb.org/ontology/core#webpage', 0, null, 'vivo:webpage', 'webpage', 0, 0, 100, '<Module ID="ApplyXSLT"><ParamList><Param Name="XSLTPath">~/profile/XSLT/Website.xslt</Param></ParamList></Module>', '<Module ID="CustomEditWebsite"/>', -20, -20, -40, -20, -40, -20, 1, 0, 0.5, 1, 1, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup)  select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Person', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#mediaLinks', 0, null, 'prns:mediaLinks', 'media links', 0, 0, 100, '<Module ID="ApplyXSLT"><ParamList><Param Name="XSLTPath">~/profile/XSLT/MediaLinks.xslt</Param></ParamList></Module>', '<Module ID="CustomEditWebsite"/>', -20, -20, -40, -20, -40, -20, 1, 0, 0.5, 1, 1, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup)  select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Person', null, 'http://vivoweb.org/ontology/core#webpage', 0, null, 'vivo:webpage', 'webpage', 0, 0, 100, '<Module ID="ApplyXSLT"><ParamList><Param Name="XSLTPath">~/profile/XSLT/Website.xslt</Param></ParamList></Module>', '<Module ID="CustomEditWebsite"/>', -20, -20, -40, -20, -40, -20, 1, 0, 0.5, 1, 1, -1 from [Ontology.].[ClassProperty]
update [Ontology.].[ClassProperty] set  IsDetail =  0 where Class= 'http://vivoweb.org/ontology/core#URLLink' and  NetworkProperty is null and  Property= 'http://vivoweb.org/ontology/core#linkAnchorText'


insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, Weight, OrderBy, ViewSecurityGroup, EditSecurityGroup, oLanguage, oStartDate, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, cInternalID, oClass, oInternalType, oInternalID, oValue, oDataType, sInternalType, sInternalID, cClass, cInternalType)  select max(DataMapID) + 1, 1, 1, 1, 'http://vivoweb.org/ontology/core#URLLink', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#publicationDate', '[Profile.Data].[vwURL]', '1', null, '-1', '-40', null, null, null, null, null, 1, null, null, null, null, 'PublicationDate', null, 'URLLink', 'URLID', null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, Weight, OrderBy, ViewSecurityGroup, EditSecurityGroup, oLanguage, oStartDate, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, cInternalID, oClass, oInternalType, oInternalID, oValue, oDataType, sInternalType, sInternalID, cClass, cInternalType)  select max(DataMapID) + 1, 1, 1, 1, 'http://vivoweb.org/ontology/core#URLLink', null, 'http://vivoweb.org/ontology/core#linkAnchorText', '[Profile.Data].[vwURL]', '1', null, '-1', '-40', null, null, null, null, null, 1, null, null, null, null, 'WebPageTitle', null, 'URLLink', 'URLID', null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, Weight, OrderBy, ViewSecurityGroup, EditSecurityGroup, oLanguage, oStartDate, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, cInternalID, oClass, oInternalType, oInternalID, oValue, oDataType, sInternalType, sInternalID, cClass, cInternalType)  select max(DataMapID) + 1, 1, 1, 1, 'http://vivoweb.org/ontology/core#URLLink', null, 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type', '[Profile.Data].[vwURL]', '1', null, '-1', '-40', null, null, null, null, null, 0, null, null, null, null, '''http://vivoweb.org/ontology/core#URLLink''', null, 'URLLink', 'URLID', null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, Weight, OrderBy, ViewSecurityGroup, EditSecurityGroup, oLanguage, oStartDate, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, cInternalID, oClass, oInternalType, oInternalID, oValue, oDataType, sInternalType, sInternalID, cClass, cInternalType)  select max(DataMapID) + 1, 1, 1, 1, 'http://vivoweb.org/ontology/core#URLLink', null, 'http://www.w3.org/2000/01/rdf-schema#label', '[Profile.Data].[vwURL]', '1', null, '-1', '-40', null, null, null, null, null, 1, null, null, null, null, 'URL', null, 'URLLink', 'URLID', null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, Weight, OrderBy, ViewSecurityGroup, EditSecurityGroup, oLanguage, oStartDate, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, cInternalID, oClass, oInternalType, oInternalID, oValue, oDataType, sInternalType, sInternalID, cClass, cInternalType)  select max(DataMapID) + 1, 1, 1, 1, 'http://vivoweb.org/ontology/core#URLLink', null, null, '[Profile.Data].[vwURL]', '1', null, '-1', '-40', null, null, null, null, null, 0, null, null, null, null, null, null, 'URLLink', 'URLID', null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, Weight, OrderBy, ViewSecurityGroup, EditSecurityGroup, oLanguage, oStartDate, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, cInternalID, oClass, oInternalType, oInternalID, oValue, oDataType, sInternalType, sInternalID, cClass, cInternalType)  select max(DataMapID) + 1, 1, 1, 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#mediaLinks', '[Profile.Data].[Group.MediaLinks]', '1', 'SortOrder', '-1', '-40', null, null, null, null, null, 0, null, 'http://vivoweb.org/ontology/core#URLLink', 'URLLink', 'URLID', null, null, 'Group', 'GroupID', null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, Weight, OrderBy, ViewSecurityGroup, EditSecurityGroup, oLanguage, oStartDate, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, cInternalID, oClass, oInternalType, oInternalID, oValue, oDataType, sInternalType, sInternalID, cClass, cInternalType)  select max(DataMapID) + 1, 1, 1, 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://vivoweb.org/ontology/core#webpage', '[Profile.Data].[Group.Websites]', '1', 'SortOrder', '-1', '-40', null, null, null, null, null, 0, null, 'http://vivoweb.org/ontology/core#URLLink', 'URLLink', 'URLID', null, null, 'Group', 'GroupID', null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, Weight, OrderBy, ViewSecurityGroup, EditSecurityGroup, oLanguage, oStartDate, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, cInternalID, oClass, oInternalType, oInternalID, oValue, oDataType, sInternalType, sInternalID, cClass, cInternalType)  select max(DataMapID) + 1, 1, 1, 1, 'http://xmlns.com/foaf/0.1/Person', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#mediaLinks', '[Profile.Data].[Person.MediaLinks]', '1', 'SortOrder', '-1', '-40', null, null, null, null, null, 0, null, 'http://vivoweb.org/ontology/core#URLLink', 'URLLink', 'URLID', null, null, 'Person', 'PersonID', null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, Weight, OrderBy, ViewSecurityGroup, EditSecurityGroup, oLanguage, oStartDate, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, cInternalID, oClass, oInternalType, oInternalID, oValue, oDataType, sInternalType, sInternalID, cClass, cInternalType)  select max(DataMapID) + 1, 1, 1, 1, 'http://xmlns.com/foaf/0.1/Person', null, 'http://vivoweb.org/ontology/core#webpage', '[Profile.Data].[Person.Websites]', '1', 'SortOrder', '-1', '-40', null, null, null, null, null, 0, null, 'http://vivoweb.org/ontology/core#URLLink', 'URLLink', 'URLID', null, null, 'Person', 'PersonID', null, null from [Ontology.].[DataMap]

delete from [Ontology.].[PropertyGroupProperty] where PropertyGroupURI= 'http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupAddress' and  PropertyURI= 'http://vivoweb.org/ontology/core#webpage'

insert into [Ontology.].[PropertyGroupProperty] ( PropertyGroupURI, PropertyURI, SortOrder, CustomDisplayModule, CustomEditModule)  values ('http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupOverview', 'http://profiles.catalyst.harvard.edu/ontology/prns#mediaLinks', 229, null, null)
insert into [Ontology.].[PropertyGroupProperty] ( PropertyGroupURI, PropertyURI, SortOrder, CustomDisplayModule, CustomEditModule)  values ('http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupOverview', 'http://vivoweb.org/ontology/core#webpage', 228, null, null)



/******************************
*
*   Lists
*
******************************/
insert into [Framework.].[Job] ( JobID,JobGroup, Script, Step, IsActive)  select max(JobID) + 1, 7, 'EXEC [Profile.Cache].[List.Export.UpdatePublications]', 16, 1 from [Framework.].[Job]

update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="connection"><PageOptions Columns="3"/><WindowName>{{{//rdf:RDF/rdf:Description[@rdf:about= ../rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{//rdf:RDF/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}</WindowName><PageColumns>3</PageColumns><PageTitle>Connection</PageTitle><PageBackLinkName>Back to Details</PageBackLinkName><PageBackLinkURL>{{{//rdf:RDF/rdf:Description[1]/prns:connectionInNetwork/@rdf:resource}}}/details</PageBackLinkURL><PageSubTitle>Similar Person</PageSubTitle><PageDescription>  This is a "connection" page, showing concepts shared by    {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}} and   {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:object/@rdf:resource]/foaf:firstName}}} {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:object/@rdf:resource]/foaf:lastName}}}.   </PageDescription><PanelTabType>Fixed</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"><ParamList><Param Name="PageType">Person</Param></ParamList></Module></Panel><Panel Type="main" TabSort="0" TabType="Default"><Module ID="SimilarConnection"><ParamList><Param Name="SubjectName">//rdf:RDF/rdf:Description/rdfs:label</Param><Param Name="SubjectURI">//rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ObjectName">//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:object/@rdf:resource]/rdfs:label</Param><Param Name="ObjectURI">//rdf:RDF/rdf:Description/rdf:object/@rdf:resource</Param></ParamList></Module></Panel><Panel Type="passive"><Module ID="HTMLBlock"><ParamList><Param Name="HTML"><div class="passiveSectionHead">               Connection Strength             </div><br/><div class="passiveSectonBody"> The connection strength for similar people is the <u>sum</u> of the scores for each shared concept.<p>A shared concept score is the <u>product</u> of the concept scores for each person.</p><p>Click any person''s concept score value to show details.</p></div></Param></ParamList></Module></Panel></PanelList><ExpandRDFList><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="2"/></ExpandRDFList></Presentation>' where Type= 'C' and  Subject= 'http://xmlns.com/foaf/0.1/Person' and  Predicate= 'http://profiles.catalyst.harvard.edu/ontology/prns#similarTo' and  Object= 'http://xmlns.com/foaf/0.1/Person'
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="connection"><PageOptions Columns="3"/><WindowName>{{{rdf:RDF[1]/rdf:Description[1]/rdfs:label[1]}}}</WindowName><PageColumns>3</PageColumns><PageTitle>Connection</PageTitle><PageBackLinkName>Back to Details </PageBackLinkName><PageBackLinkURL>{{{//rdf:RDF/rdf:Description/prns:connectionInNetwork/@rdf:resource}}}/details</PageBackLinkURL><PageSubTitle> {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}}  {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}  to  {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:object/@rdf:resource]/rdfs:label}}} </PageSubTitle><PageDescription> This is a "connection" page, showing publications  {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}}  {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}  has written about  {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:object/@rdf:resource]/rdfs:label}}}. </PageDescription><PanelTabType>Fixed</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"><ParamList><Param Name="PageType">Person</Param></ParamList></Module></Panel><Panel Type="main" TabSort="0" TabType="Default"><Module ID="ConceptConnection"><ParamList><Param Name="SubjectName">//rdf:RDF/rdf:Description/rdfs:label</Param><Param Name="SubjectURI">//rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ObjectName">//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:object/@rdf:resource]/rdfs:label</Param><Param Name="ObjectURI">//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:object/@rdf:resource]/@rdf:about</Param></ParamList></Module></Panel><Panel Type="passive"><Module ID="HTMLBlock"><ParamList><Param Name="HTML"><div class="passiveSectionHead">    Connection Strength  </div><br/><div class="passiveSectionBody"> The connection strength for concepts is the <u>sum</u> of the scores for each matching publication.  <br/><br/>   Publication scores are based on many factors, including how long ago they were written and whether the person is a first or senior author.  </div></Param></ParamList></Module></Panel></PanelList><ExpandRDFList><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="2"/></ExpandRDFList></Presentation>' where Type= 'C' and  Subject= 'http://xmlns.com/foaf/0.1/Person' and  Predicate= 'http://vivoweb.org/ontology/core#hasResearchArea' and  Object= 'http://www.w3.org/2004/02/skos/core#Concept'
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="connection"><PageOptions Columns="3"/><WindowName>{{{rdf:RDF[1]/rdf:Description[1]/rdfs:label[1]}}}</WindowName><PageColumns>3</PageColumns><PageTitle>Connection</PageTitle><PageBackLinkName>Back to Details</PageBackLinkName><PageBackLinkURL>{{{//rdf:RDF/rdf:Description/prns:connectionInNetwork/@rdf:resource}}}/details</PageBackLinkURL><PageSubTitle>Co-Authors</PageSubTitle><PageDescription>This is a "connection" page, showing publications co-authored by   {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}   and   {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:object/@rdf:resource]/foaf:firstName}}} {{{//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:object/@rdf:resource]/foaf:lastName}}}.   </PageDescription><PanelTabType>Fixed</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"><ParamList><Param Name="PageType">Person</Param></ParamList></Module></Panel><Panel Type="main" TabSort="0" TabType="Default"><Module ID="CoAuthorConnection"><ParamList><Param Name="SubjectName">//rdf:RDF/rdf:Description/rdfs:label</Param><Param Name="SubjectURI">//rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ObjectName">//rdf:RDF/rdf:Description[@rdf:about=/rdf:RDF/rdf:Description[1]/rdf:object/@rdf:resource]/rdfs:label</Param><Param Name="ObjectURI">//rdf:RDF/rdf:Description/rdf:object/@rdf:resource</Param></ParamList></Module></Panel><Panel Type="passive"><Module ID="HTMLBlock"><ParamList><Param Name="HTML"><div class="passiveSectionHead">       Connection Strength      </div><br/><div class="passiveSectionBody"> The connection strength for concepts is the <u>sum</u> of the scores for each matching publication.    <br/><br/>         Publication scores are based on many factors, including how long ago they were written and whether the person is a first or senior author.    </div></Param></ParamList></Module></Panel></PanelList><ExpandRDFList><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="2"/></ExpandRDFList></Presentation>' where Type= 'C' and  Subject= 'http://xmlns.com/foaf/0.1/Person' and  Predicate= 'http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf' and  Object= 'http://xmlns.com/foaf/0.1/Person'
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="network"><PageOptions Columns="3"/><WindowName>{{{//rdf:RDF/rdf:Description[@rdf:about= ../rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{//rdf:RDF/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}''s research topics</WindowName><PageColumns>3</PageColumns><PageTitle>{{{//rdf:RDF/rdf:Description[@rdf:about= ../rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{//rdf:RDF/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}</PageTitle><PageBackLinkName>Back to Profile</PageBackLinkName><PageBackLinkURL>{{{//rdf:RDF/rdf:Description/rdf:subject/@rdf:resource}}}</PageBackLinkURL><PageSubTitle>Concepts  ({{{//rdf:RDF/rdf:Description/prns:numberOfConnections}}})</PageSubTitle><PageDescription>Concepts are derived automatically from a person''s publications.</PageDescription><PanelTabType>Default</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"><ParamList><Param Name="PageType">Person</Param></ParamList></Module></Panel><Panel Type="main" TabSort="0" TabType="Default" Alias="cloud" Name="Cloud"><Module ID="NetworkList"><ParamList><Param Name="Cloud">true</Param></ParamList></Module></Panel><Panel Type="main" TabSort="1" Alias="categories" Name="Categories"><Module ID="NetworkCategories"><ParamList><Param Name="InfoCaption">Concepts listed here are grouped according to their ''semantic'' categories. Within each category, up to ten concepts are shown, in decreasing order of relevance.</Param><Param Name="NetworkListNode">rdf:RDF/rdf:Description[@rdf:about= //rdf:RDF/rdf:Description/prns:hasConnection/@rdf:resource]</Param><Param Name="CategoryPath">//prns:meshSemanticGroupName</Param><Param Name="ItemText">{{{//rdf:Description/rdfs:label}}}</Param><Param Name="ItemURL">{{{//rdf:Description/@rdf:about}}}</Param></ParamList></Module></Panel><Panel Type="main" TabSort="2" Alias="timeline" Name="Timeline"><Module ID="NetworkTimeline"><ParamList><Param Name="TimelineType">Concept</Param><Param Name="InfoCaption">The timeline below shows the dates (blue tick marks) of publications associated with @SubjectName''s top concepts. The average publication date for each concept is shown as a red circle, illustrating changes in the primary topics that @SubjectName has written about over time.</Param></ParamList></Module></Panel><Panel Type="main" TabSort="3" Alias="details" Name="Details"><Module ID="ApplyXSLT"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="XSLTPath">~/profile/XSLT/ConceptDetail.xslt</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="2"/><ExpandRDF Class="http://www.w3.org/2004/02/skos/core#Concept" Property="http://profiles.catalyst.harvard.edu/ontology/prns#numberOfPublications" IsDetail="false"/></Param></ParamList></Module></Panel><Panel Type="passive"><Module ID="PassiveHeader"/><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Concepts</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="Description">Derived automatically from this person''s publications.</Param><Param Name="MaxDisplay">5</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/vivo:hasResearchArea/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) concept(s)</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Co-Authors</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="MaxDisplay">5</Param><Param Name="Description">People in Profiles who have published with this person.</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:coAuthorOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Similar People</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="Description">People who share similar concepts with this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:similarTo/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="CustomViewPersonSameDepartment"/><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Physical Neighbors</Param><Param Name="Description">People whose addresses are nearby this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:physicalNeighborOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param></ParamList></Module></Panel></PanelList><ExpandRDFList><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="2"/></ExpandRDFList></Presentation>' where Type= 'N' and  Subject= 'http://xmlns.com/foaf/0.1/Person' and  Predicate= 'http://vivoweb.org/ontology/core#hasResearchArea' and  Object is null
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="network"><PageOptions Columns="3"/><WindowName>{{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}''s co-authors</WindowName><PageColumns>3</PageColumns><PageTitle>{{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}</PageTitle><PageBackLinkName>Back to Profile</PageBackLinkName><PageBackLinkURL>{{{//rdf:RDF/rdf:Description/rdf:subject/@rdf:resource}}}</PageBackLinkURL><PageSubTitle>Co-Authors ({{{//rdf:RDF/rdf:Description/prns:numberOfConnections}}})</PageSubTitle><PageDescription>Co-Authors are people in Profiles who have published together.</PageDescription><PanelTabType>Default</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"><ParamList><Param Name="PageType">Person</Param></ParamList></Module></Panel><Panel Type="main" TabSort="0" TabType="Default" Alias="list" Name="List"><Module ID="NetworkList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="BulletType">disc</Param><Param Name="Columns">2</Param><Param Name="NetworkListNode">rdf:RDF/rdf:Description[@rdf:about= ../rdf:Description[1]/prns:hasConnection/@rdf:resource]</Param><Param Name="ItemURLText">{{{rdf:Description/rdf:object/@rdf:resource}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/rdf:object/@rdf:resource}}}</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="2"/></Param></ParamList></Module></Panel><Panel Type="main" TabSort="1" Alias="map" Name="Map" DisplayRule="rdf:RDF/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/prns:latitude"><Module ID="NetworkMap"><ParamList><Param Name="MapType">CoAuthor</Param></ParamList></Module></Panel><Panel Type="main" TabSort="2" Alias="radial" Name="Radial"><Module ID="NetworkRadial"/></Panel><Panel Type="main" TabSort="3" Alias="cluster" Name="Cluster"><Module ID="NetworkCluster"/></Panel><Panel Type="main" TabSort="4" Alias="timeline" Name="Timeline"><Module ID="NetworkTimeline"><ParamList><Param Name="TimelineType">CoAuthor</Param><Param Name="InfoCaption">The timeline below shows the dates (blue tick marks) of publications @SubjectName co-authored with other people in Profiles. The average publication date for each co-author is shown as a red circle, illustrating changes in the people that @SubjectName has worked with over time.</Param></ParamList></Module></Panel><Panel Type="main" TabSort="5" Alias="details" Name="Details"><Module ID="ApplyXSLT"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="XSLTPath">~/profile/XSLT/CoAuthorDetail.xslt</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="2"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://profiles.catalyst.harvard.edu/ontology/prns#fullName" IsDetail="false"/></Param></ParamList></Module></Panel><Panel Type="passive"><Module ID="PassiveHeader"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Concepts</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="Description">Derived automatically from this person''s publications.</Param><Param Name="MaxDisplay">5</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/vivo:hasResearchArea/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) concept(s)</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Co-Authors</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="MaxDisplay">5</Param><Param Name="Description">People in Profiles who have published with this person.</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:coAuthorOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Similar People</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="Description">People who share similar concepts with this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:similarTo/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="CustomViewPersonSameDepartment"/><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Physical Neighbors</Param><Param Name="Description">People whose addresses are nearby this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:physicalNeighborOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param></ParamList></Module></Panel></PanelList><ExpandRDFList><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="2"/></ExpandRDFList></Presentation>' where Type= 'N' and  Subject= 'http://xmlns.com/foaf/0.1/Person' and  Predicate= 'http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf' and  Object is null
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="network"><PageOptions Columns="3"/><WindowName>{{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}''s related authors</WindowName><PageColumns>3</PageColumns><PageTitle>{{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}</PageTitle><PageBackLinkName>Back to Profile</PageBackLinkName><PageBackLinkURL>{{{//rdf:RDF/rdf:Description/rdf:subject/@rdf:resource}}}</PageBackLinkURL><PageSubTitle>Similar People ({{{//rdf:RDF/rdf:Description/prns:numberOfConnections}}})</PageSubTitle><PageDescription>Similar people share similar sets of concepts, but are not necessarily co-authors.</PageDescription><PanelTabType>Default</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"><ParamList><Param Name="PageType">Person</Param></ParamList></Module></Panel><Panel Type="main" TabSort="0" TabType="Default" Alias="list" Name="List"><Module ID="NetworkList"><ParamList><Param Name="InfoCaption">The people in this list are ordered by decreasing similarity.     (<font color="red">*</font> These people are also co-authors.)</Param><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="BulletType">disc</Param><Param Name="Columns">2</Param><Param Name="NetworkListNode">rdf:RDF/rdf:Description[@rdf:about= ../rdf:Description[1]/prns:hasConnection/@rdf:resource]</Param><Param Name="ItemURLText">{{{rdf:Description/rdf:object/@rdf:resource}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/rdf:object/@rdf:resource}}}</Param><Param Name="SortBy">Weight</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="2"/></Param></ParamList></Module></Panel><Panel Type="main" TabSort="1" Alias="map" Name="Map" DisplayRule="rdf:RDF/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/prns:latitude"><Module ID="NetworkMap"><ParamList><Param Name="MapType">SimilarTo</Param></ParamList></Module></Panel><Panel Type="main" TabSort="3" Alias="details" Name="Details"><Module ID="ApplyXSLT"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="XSLTPath">~/profile/XSLT/SimilarPeopleDetail.xslt</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="2"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://profiles.catalyst.harvard.edu/ontology/prns#fullName" IsDetail="false"/></Param></ParamList></Module></Panel><Panel Type="passive"><Module ID="PassiveHeader"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Concepts</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="Description">Derived automatically from this person''s publications.</Param><Param Name="MaxDisplay">5</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/vivo:hasResearchArea/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) concept(s)</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Co-Authors</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="MaxDisplay">5</Param><Param Name="Description">People in Profiles who have published with this person.</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:coAuthorOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Similar People</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="Description">People who share similar concepts with this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:similarTo/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="CustomViewPersonSameDepartment"/><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></Param><Param Name="InfoCaption">Physical Neighbors</Param><Param Name="Description">People whose addresses are nearby this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:physicalNeighborOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param></ParamList></Module></Panel></PanelList><ExpandRDFList><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="2"/></ExpandRDFList></Presentation>' where Type= 'N' and  Subject= 'http://xmlns.com/foaf/0.1/Person' and  Predicate= 'http://profiles.catalyst.harvard.edu/ontology/prns#similarTo' and  Object is null
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="profile"><PageOptions Columns="3"/><WindowName>{{{rdf:RDF[1]/rdf:Description[1]/foaf:firstName[1]}}} {{{rdf:RDF[1]/rdf:Description[1]/foaf:lastName[1]}}}</WindowName><PageColumns>3</PageColumns><PageTitle>{{{rdf:RDF[1]/rdf:Description[1]/prns:fullName[1]}}}</PageTitle><PageBackLinkName/><PageBackLinkURL/><PageSubTitle/><PageDescription/><PanelTabType>Fixed</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"><ParamList><Param Name="PageType">Person</Param></ParamList></Module></Panel><Panel Type="main" TabType="Fixed"><Module ID="CustomViewPersonGeneralInfo"/><Module ID="ApplyXSLT"><ParamList><Param Name="XSLTPath">~/profile/XSLT/OtherPositions.xslt</Param></ParamList></Module><Module ID="PropertyList"><ParamList/></Module><Module ID="HRFooter"/></Panel><Panel Type="passive"><Module ID="PassiveHeader"><ParamList><Param Name="DisplayRule">rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections</Param><Param Name="DisplayRule">rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections</Param><Param Name="DisplayRule">rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="InfoCaption">Concepts</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="Description">Derived automatically from this person''s publications.</Param><Param Name="MaxDisplay">5</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/vivo:hasResearchArea/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) concept(s)</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="InfoCaption">Co-Authors</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="MaxDisplay">5</Param><Param Name="Description">People in Profiles who have published with this person.</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:coAuthorOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="InfoCaption">Similar People</Param><Param Name="TotalCount">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}</Param><Param Name="Description">People who share similar concepts with this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:similarTo/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="CustomViewPersonSameDepartment"/><Module ID="Gadgets"><ParamList><Param Name="HTML"><div id="gadgets-tools" class="gadgets-gadget-parent"/></Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="InfoCaption">Physical Neighbors</Param><Param Name="Description">People whose addresses are nearby this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:physicalNeighborOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param></ParamList></Module></Panel></PanelList><ExpandRDFList><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="1"/></ExpandRDFList></Presentation>' where Type= 'P' and  Subject= 'http://xmlns.com/foaf/0.1/Person' and  Predicate is null and  Object is null
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="profile"><PageOptions Columns="3"/><WindowName>{{{rdf:RDF[1]/rdf:Description[1]/rdfs:label[1]}}}</WindowName><PageColumns>3</PageColumns><PageTitle>{{{rdf:RDF[1]/rdf:Description[1]/rdfs:label[1]}}}</PageTitle><PageBackLinkName/><PageBackLinkURL/><PageSubTitle/><PageDescription/><PanelTabType>Fixed</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"/></Panel><Panel Type="main" TabSort="0" TabType="Default"><Module ID="CustomViewConceptMeshInfo"><ParamList/></Module></Panel><Panel Type="main" TabSort="0" TabType="Default"><Module ID="CustomViewConceptPublication"><ParamList><Param Name="TimelineCaption">This graph shows the total number of publications written about "@ConceptName" by people in this website by year, and whether "@ConceptName" was a major or minor topic of these publications. &lt;!--In all years combined, a total of [[[TODO:PUBLICATION COUNT]]] publications were written by people in Profiles.--&gt;</Param><Param Name="CitedCaption">Below are the publications written about "@ConceptName" that have been cited the most by articles in Pubmed Central.</Param><Param Name="NewestCaption">Below are the most recent publications written about "@ConceptName" by people in Profiles.</Param><Param Name="OldestCaption">Below are the earliest publications written about "@ConceptName" by people in Profiles.</Param></ParamList></Module></Panel><Panel Type="passive"><Module ID="PassiveList"><ParamList><Param Name="InfoCaption">People</Param><Param Name="Description">People who have written about this concept.</Param><Param Name="MaxDisplay">5</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/vivo:researchAreaOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">[[[Root]]]/search/default.aspx?searchtype=people&amp;searchfor={{{rdf:RDF/rdf:Description/rdfs:label}}}&amp;perpage=15&amp;offset=0&amp;new=true</Param><Param Name="MoreText">See all people</Param></ParamList></Module><Module ID="CustomViewConceptSimilarMesh"><ParamList><Param Name="InfoCaption">Similar Concepts</Param><Param Name="Description">Similar concepts derived from published works.</Param></ParamList></Module><Module ID="CustomViewConceptTopJournal"><ParamList><Param Name="InfoCaption">Top Journals</Param><Param Name="Description">Top journals in which articles about this concept have been published.</Param></ParamList></Module></Panel></PanelList><ExpandRDFList><ExpandRDFOptions ExpandPredicates="false" ClassPropertyCustomTypeID="3"/></ExpandRDFList></Presentation>' where Type= 'P' and  Subject= 'http://www.w3.org/2004/02/skos/core#Concept' and  Predicate is null and  Object is null



GO
INSERT [Profile.Import].[PRNSWebservice.Options] ([job], [url], [apiKey], [logLevel], [batchSize]) VALUES (N'bibliometrics', N'http://profiles.catalyst.harvard.edu/services/GetPMIDs/GetBibliometricData.asp', NULL, 1, 10000)
GO
INSERT [Profile.Import].[PRNSWebservice.Options] ([job], [url], [apiKey], [logLevel], [batchSize]) VALUES (N'geocode', N'https://maps.googleapis.com/maps/api/geocode/xml?address=', N'InvalidKey', 2, NULL)
GO


/******************************
*
*   Update all derived fields
*
******************************/
EXEC [Ontology.].[UpdateDerivedFields]
EXEC [Ontology.].[UpdateCounts]
EXEC [Ontology.].CleanUp @action='UpdateIDs'

GO