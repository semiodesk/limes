/*

Run this script on:

	Profiles RNS Version 2.10.1

to update its data to:

	Profiles RNS Version 2.11.0

*** You are recommended to back up your database before running this script!

*** You should review each step of this script to ensure that it will not overwrite any customizations you have made to ProfilesRNS.

*** Make sure you run the ProfilesRNS_Upgrade_Schema.sql file before running this file.
 
 *** Modify line 31, replace $(ProfilesRNSRootPath)\Data with the location that contains the various XML files that came with Profiles RNS 2.5.1 (not an older version of that file). These file has to be on the database server, not your local machine.
  
*/

--*****************************************************************************************
--*****************************************************************************************
--*****************************************************************************************
--*****
--***** Load new ontology and install data files
--*****
--*****************************************************************************************
--*****************************************************************************************
--*****************************************************************************************

EXEC [Framework.].[LoadXMLFile] @FilePath = '$(ProfilesRNSRootPath)\Data\PRNS_1.3.owl', @TableDestination = '[Ontology.Import].owl', @DestinationColumn = 'DATA', @NameValue = 'PRNS_1.3'


-- Import the Updated PRNS and new ORNG ontology into Profiles. This should not eliminate any customizations unless additional 
-- classes have been added to the PRNS ontology
UPDATE [Ontology.Import].OWL SET Graph = 3 WHERE name = 'PRNS_1.3'
EXEC [Ontology.Import].[ConvertOWL2Triple] @OWL = 'PRNS_1.3'

EXEC [RDF.Stage].[LoadTriplesFromOntology] @Truncate = 1
EXEC [RDF.Stage].[ProcessTriples]


--*****************************************************************************************
--*****************************************************************************************
--*****************************************************************************************
--*****
--***** Update Direct2Experts Site List
--*****
--*****************************************************************************************
--*****************************************************************************************
--*****************************************************************************************

delete from [Direct.].[Sites] where SiteName= 'John Hopkins University'
delete from [Direct.].[Sites] where SiteName= 'MD Anderson'
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Augusta University', 'https://augusta.pure.elsevier.com/direct2experts/fs.xhtml', 'https://augusta.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Baylor College of Medicine', 'http://profiles.viictr.org/direct.xml', 'http://profiles.viictr.org/DirectService.aspx?Request=IncomingCount&SearchPhrase=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Case Western Reserve University', 'https://cwru.pure.elsevier.com/direct2experts/fs.xhtml', 'https://cwru.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'David Geffen School of Medicine at UCLA', 'http://people.ctsi.ucla.edu/institution/d2x/bootstrap.xml', 'http://people.ctsi.ucla.edu/ctsi/institution/d2x/search.xml?form:id=search&q=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Educatio Társadalmi Szolgáltató Nonprofit Kft.', 'https://hungary.pure.elsevier.com/direct2experts/fs.xhtml', 'https://hungary.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Johns Hopkins University', 'https://jhu.pure.elsevier.com/direct2experts/fs.xhtml', 'https://jhu.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Kawasaki (COINS)', 'https://coins.pure.elsevier.com/direct2experts/fs.xhtml', 'https://coins.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Keio University', 'https://keio.pure.elsevier.com/direct2experts/fs.xhtml', 'https://keio.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Korea University', 'https://koreauniv.pure.elsevier.com/direct2experts/fs.xhtml', 'https://koreauniv.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Mayo Clinic', 'https://mayoclinic.pure.elsevier.com/direct2experts/fs.xhtml', 'https://mayoclinic.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'MD Anderson Cancer Center', 'https://mdanderson.influuent.utsystem.edu/direct2experts/fs.xhtml', 'https://mdanderson.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Michigan State University', 'https://msu.pure.elsevier.com/direct2experts/fs.xhtml', 'https://scholars.opb.msu.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'National Taiwan Normal University', 'https://ntnu.pure.elsevier.com/direct2experts/fs.xhtml', 'https://scholar.lib.ntnu.edu.tw/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Northern Arizona University', 'https://nau.pure.elsevier.com/direct2experts/fs.xhtml', 'https://nau.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Sapienza University of Rome', 'https://sapienza.pure.elsevier.com/direct2experts/fs.xhtml', 'https://sapienza.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Scholars@Duke', 'https://scholars.duke.edu/FS.xml', 'https://scholars.duke.edu/ctsasearch?querytext=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Shibaura Institute of Technology', 'https://shibaura.pure.elsevier.com/direct2experts/fs.xhtml', 'https://shibaura.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'SOFI Northwestern', 'https://sofi-northwestern.pure.elsevier.com/direct2experts/fs.xhtml', 'https://sofi-northwestern.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Stephenson Cancer Center', 'https://stephenson.pure.elsevier.com/direct2experts/fs.xhtml', 'https://stephenson.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Taipei Medical University', 'https://tmu.pure.elsevier.com/direct2experts/fs.xhtml', 'https://tmu.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'The University of Arizona', 'https://arizona.pure.elsevier.com/direct2experts/fs.xhtml', 'https://arizona.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'The University of Texas Arlington', 'https://uta.pure.elsevier.com/direct2experts/fs.xhtml', 'https://uta.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'The University of Texas at Austin', 'https://utaustin.pure.elsevier.com/direct2experts/fs.xhtml', 'https://utexas.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'The University of Texas at Dallas', 'https://utdallas.pure.elsevier.com/direct2experts/fs.xhtml', 'https://utdallas.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'The University of Texas at El Paso', 'https://utep.pure.elsevier.com/direct2experts/fs.xhtml', 'https://utep.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'UC Davis Health System', 'https://ucdavis.pure.elsevier.com/direct2experts/fs.xhtml', 'https://ucdavis.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Universiti Kebangsaan Malaysia', 'https://ukm.pure.elsevier.com/direct2experts/fs.xhtml', 'https://ukm.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Universiti Teknologi Malaysia', 'https://pure.utm.my/direct2experts/fs.xhtml', 'https://pure.utm.my/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Arkansas for Medical Sciences', 'https://uams-triprofiles.uams.edu/profiles/DIRECT/Modules/DirectSearch/Direct.xml', 'https://uams-triprofiles.uams.edu/profiles/DIRECT/Modules/DirectSearch/DirectService.aspx?Request=IncomingCount&SearchPhrase=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Chicago', 'http://profiles.uchicago.edu/DIRECT/DIRECT.xml', 'https://profiles.uchicago.edu/profiles/DIRECT/Modules/DirectSearch/DirectService.aspx?Request=IncomingCount&SearchPhrase=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Colorado Profiles', 'https://profiles.ucdenver.edu/direct.xml', 'https://profiles.ucdenver.edu/DIRECT/Modules/DirectSearch/DirectService.aspx?Request=IncomingCount&SearchPhrase=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of New Mexico', 'https://ctsc.health.unm.edu/apps/d2e/unm_fs.php?return=desc', 'http://ctsc.health.unm.edu/apps/d2e/unm_fs.php?return=xml&querytext=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Rochester Medical Center', 'http://www.urmc.rochester.edu/profiles/DIRECT/direct.xml', 'http://www.urmc.rochester.edu/profiles/DIRECT/Modules/DirectSearch/DirectService.aspx?Request=IncomingCount&SearchPhrase=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Southern California', 'http://profilesv2.sc-ctsi.org/profiles/direct.xml', 'http://profilesv2.sc-ctsi.org/profiles/DirectService.aspx?Request=IncomingCount&SearchPhrase=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Texas at San Antonio', 'https://utsanantonio.pure.elsevier.com/direct2experts/fs.xhtml', 'https://utsa.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Texas at UT Tyler', 'https://uttyler.pure.elsevier.com/direct2experts/fs.xhtml', 'https://uttyler.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Texas Health Science Center at Houston (UTHealth)', 'https://uthealth.influuent.utsystem.edu/direct2experts/fs.xhtml', 'https://uthealth.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Texas Medical Branch at Galveston', 'https://utmb.pure.elsevier.com/direct2experts/fs.xhtml', 'https://utmb.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Texas of the Permian Basin', 'https://utpb.pure.elsevier.com/direct2experts/fs.xhtml', 'https://utpb.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Tokyo', 'https://utokyo.pure.elsevier.com/direct2experts/fs.xhtml', 'https://utokyo.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'University of Utah', 'https://utah.pure.elsevier.com/direct2experts/fs.xhtml', 'https://utah.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'UT Health Northeast/UTHSC Tyler', 'https://uthsct.influuent.utsystem.edu/direct2experts/fs.xhtml', 'https://uthsct.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'UT Southwestern Medical Center', 'https://utsouthwestern.pure.elsevier.com/direct2experts/fs.xhtml', 'https://utsouthwestern.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Wake Forest Baptist Medical Center', 'http://profiles.tsi.wakehealth.edu/direct/direct.xml', 'http://profiles.tsi.wakehealth.edu/DIRECT/Modules/DirectSearch/DirectService.aspx?Request=IncomingCount&SearchPhrase=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'WASEDA University', 'https://waseda.pure.elsevier.com/direct2experts/fs.xhtml', 'https://waseda.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Wayne State University''s Research Connect', 'https://researchconnect.wayne.edu/direct2experts/fs.xhtml', 'https://researchconnect.wayne.edu/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
insert into [Direct.].[Sites] ( SiteID,SiteName, BootstrapURL, QueryURL, SortOrder, IsActive) 
select max(SiteID) + 1, 'Western Michigan University', 'https://wmich.pure.elsevier.com/direct2experts/fs.xhtml', 'https://wmich.pure.elsevier.com/direct2experts/fs_search.xhtml?search=', max(SortOrder) + 1, 1 from [Direct.].[Sites]
update [Direct.].[Sites] set  BootstrapURL = 'http://www.scholars.northwestern.edu/direct2experts/fs.xhtml', QueryURL = 'https://www.scholars.northwestern.edu/direct2experts/fs_search.xhtml?search=' where SiteName= 'Northwestern University'
update [Direct.].[Sites] set  BootstrapURL = 'https://asu.pure.elsevier.com/direct2experts/fs.xhtml', QueryURL = 'https://asu.pure.elsevier.com/direct2experts/fs_search.xhtml?search=' where SiteName= 'Arizona State University'
update [Direct.].[Sites] set  BootstrapURL = 'https://digitalvita.pitt.edu/federation/bootstrap.php', QueryURL = 'https://digitalvita.pitt.edu:443/federation/aggregateQuery.php?query=' where SiteName= 'University of Pittsburgh'
update [Direct.].[Sites] set  BootstrapURL = 'https://einstein.pure.elsevier.com/direct2experts/fs.xhtml', QueryURL = 'https://einstein.pure.elsevier.com/direct2experts/fs_search.xhtml?search=' where SiteName= 'Albert Einstein College of Medicine'
update [Direct.].[Sites] set  BootstrapURL = 'https://experts.umich.edu/direct2experts/fs.xhtml', QueryURL = 'https://experts.umich.edu/direct2experts/fs_search.xhtml?search=' where SiteName= 'University of Michigan'
update [Direct.].[Sites] set  BootstrapURL = 'https://experts.umn.edu/direct2experts/fs.xhtml', QueryURL = 'https://experts.umn.edu/direct2experts/fs_search.xhtml?search=' where SiteName= 'University of Minnesota'
update [Direct.].[Sites] set  BootstrapURL = 'https://indiana.pure.elsevier.com/direct2experts/fs.xhtml', QueryURL = 'https://indiana.pure.elsevier.com/direct2experts/fs_search.xhtml?search=' where SiteName= 'Indiana University School of Medicine'
update [Direct.].[Sites] set  BootstrapURL = 'https://miami.pure.elsevier.com/direct2experts/fs.xhtml', QueryURL = 'https://miami.pure.elsevier.com/direct2experts/fs_search.xhtml?search=' where SiteName= 'University of Miami'
update [Direct.].[Sites] set  BootstrapURL = 'https://nebraska.pure.elsevier.com/direct2experts/fs.xhtml', QueryURL = 'https://nebraska.pure.elsevier.com/direct2experts/fs_search.xhtml?search=' where SiteName= 'University of Nebraska'
update [Direct.].[Sites] set  BootstrapURL = 'https://ohsu.pure.elsevier.com/direct2experts/fs.xhtml', QueryURL = 'https://ohsu.pure.elsevier.com/direct2experts/fs_search.xhtml?search=' where SiteName= 'Oregon Health & Science University'
update [Direct.].[Sites] set  BootstrapURL = 'https://uic.pure.elsevier.com/direct2experts/fs.xhtml', QueryURL = 'https://uic.pure.elsevier.com/direct2experts/fs_search.xhtml?search=' where SiteName= 'University of Illinois at Chicago'
update [Direct.].[Sites] set  BootstrapURL = 'https://uthscsa.influuent.utsystem.edu/direct2experts/fs.xhtml', QueryURL = 'https://uthscsa.influuent.utsystem.edu/direct2experts/fs_search.xhtml?search=' where SiteName= 'UT Health Science Center'
update [Direct.].[Sites] set  QueryURL = 'http://profiles.psu.edu/profiles/DIRECT/Modules/DirectSearch/DirectService.aspx?Request=IncomingCount&SearchPhrase=' where SiteName= 'Pennsylvania State University'

-- Alphabetize the sort direct sites sort order 
;with newSortOrders as(
        select SiteID, ROW_NUMBER() over (order by SiteName) as NewSortOrder  from [Direct.].[Sites]
)
update s set SortOrder = newSortOrder from [Direct.].Sites s join newSortOrders n on s.SiteID = n.SiteID



--*****************************************************************************************
--*****************************************************************************************
--*****************************************************************************************
--*****
--***** Group Profiles
--*****
--*****************************************************************************************
--*****************************************************************************************
--*****************************************************************************************

insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://vivoweb.org/ontology/core#MemberRole', null, 'http://vivoweb.org/ontology/core#roleContributesTo', 0, null, 'vivo:roleContributesTo', 'contributes to', 0, 0, null, null, null, -40, -40, -40, -40, -40, -40, 1, 1, 1, 0, 0, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://orng.info/ontology/orng#hasLinks', 1, null, 'orng:hasLinks', 'Websites', 0, 0, null, '<Module ID="ViewPersonalGadget"><ParamList><Param Name="AppId">103</Param><Param Name="Label">Websites</Param><Param Name="View">profile</Param><Param Name="OptParams">{''hide_titlebar'':1}</Param></ParamList></Module>', '<Module ID="EditPersonalGadget"><ParamList><Param Name="AppId">103</Param><Param Name="Label">Websites</Param><Param Name="View">home</Param><Param Name="OptParams">{''hide_titlebar'':1}</Param></ParamList></Module>', -50, -50, -50, -50, -50, -50, 0, 0, 0, 1, 1, -50 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://orng.info/ontology/orng#hasSlideShare', 1, null, 'orng:hasSlideShare', 'Featured Presentations', 0, 0, null, '<Module ID="ViewPersonalGadget"><ParamList><Param Name="AppId">101</Param><Param Name="Label">Featured Presentations</Param><Param Name="View">profile</Param><Param Name="OptParams">{''hide_titlebar'':1}</Param></ParamList></Module>', '<Module ID="EditPersonalGadget"><ParamList><Param Name="AppId">101</Param><Param Name="Label">Featured Presentations</Param><Param Name="View">home</Param><Param Name="OptParams">{''hide_titlebar'':1}</Param></ParamList></Module>', -50, -50, -50, -50, -50, -50, 0, 0, 0, 1, 1, -50 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://orng.info/ontology/orng#hasTwitter', 1, null, 'orng:hasTwitter', 'Twitter', 0, 0, null, '<Module ID="ViewPersonalGadget"><ParamList><Param Name="AppId">112</Param><Param Name="Label">Twitter</Param><Param Name="View">profile</Param><Param Name="OptParams">{''hide_titlebar'':1}</Param></ParamList></Module>', '<Module ID="EditPersonalGadget"><ParamList><Param Name="AppId">112</Param><Param Name="Label">Twitter</Param><Param Name="View">home</Param><Param Name="OptParams">{''hide_titlebar'':1}</Param></ParamList></Module>', -50, -50, -50, -50, -50, -50, 0, 0, 0, 1, 1, -50 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://orng.info/ontology/orng#hasYouTube', 1, null, 'orng:hasYouTube', 'Featured Videos', 0, 0, null, '<Module ID="ViewPersonalGadget"><ParamList><Param Name="AppId">114</Param><Param Name="Label">Featured Videos</Param><Param Name="View">profile</Param><Param Name="OptParams">{''hide_titlebar'':1}</Param></ParamList></Module>', '<Module ID="EditPersonalGadget"><ParamList><Param Name="AppId">114</Param><Param Name="Label">Featured Videos</Param><Param Name="View">home</Param><Param Name="OptParams">{''hide_titlebar'':1}</Param></ParamList></Module>', -50, -50, -50, -50, -50, -50, 0, 0, 0, 1, 1, -50 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#aboutUs', 1, null, 'prns:aboutUs', 'about us', 1, 0, 1, null, null, -20, -20, -20, -20, -40, -20, 0, 0, 0.5, 0, 0, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#associatedInformationResource', 1, null, 'prns:associatedInformationResource', 'selected publications', 1, 0, null, '<Module ID="CustomViewAuthorInAuthorship"/>', '<Module ID="CustomEditAssociatedInformationResource"/>', -20, -20, -20, -20, -20, -20, 0, 0, 0.5, 1, 1, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#hasGroupManager', 1, null, 'prns:hasGroupManager', 'group managers', 0, 0, null, null, '<Module ID="CustomEditGroupMember"/>', -20, -20, -20, -20, -20, -20, 1, 0, 0, 1, 1, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#hasGroupSettings', 0, null, 'prns:hasGroupSettings', 'group settings', 1, 0, null, null, '<Module ID="CustomEditGroupSettings"/>', -20, -20, -20, -20, -20, -20, 0, 0, 0, 1, 1, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#mainImage', 0, null, 'prns:mainImage', 'photo', 0, 0, null, null, '<Module ID="CustomEditMainImage"/>', -20, -20, -40, -20, -20, -20, 0, 0, 0, 1, 1, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#welcome', 1, null, 'prns:welcome', 'welcome', 1, 0, 1, null, null, -20, -20, -20, -20, -40, -20, 0, 0, 0.5, 0, 0, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://vivoweb.org/ontology/core#contactInformation', 1, null, 'vivo:contactInformation', 'contact information', 1, 0, 1, null, null, -20, -20, -20, -20, -40, -20, 0, 0, 0, 0, 0, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://vivoweb.org/ontology/core#contributingRole', 1, 20, 'vivo:contributingRole', 'members', 0, 0, null, null, '<Module ID="CustomEditGroupMember"/>', -20, -20, -40, -20, -40, -20, 1, 1, 0.1, 1, 1, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://vivoweb.org/ontology/core#overview', 1, null, 'vivo:overview', 'overview', 1, 0, 1, null, null, -20, -20, -20, -20, -40, -20, 0, 0, 0.5, 0, 0, -1 from [Ontology.].[ClassProperty]
insert into [Ontology.].[ClassProperty] ( ClassPropertyID,Class, NetworkProperty, Property, IsDetail, Limit, _TagName, _PropertyLabel, _ObjectType, MinCardinality, MaxCardinality, CustomDisplayModule, CustomEditModule, EditSecurityGroup, EditPermissionsSecurityGroup, EditExistingSecurityGroup, EditAddNewSecurityGroup, EditAddExistingSecurityGroup, EditDeleteSecurityGroup, IncludeDescription, IncludeNetwork, SearchWeight, CustomDisplay, CustomEdit, ViewSecurityGroup) 
select max(ClassPropertyID) + 1, 'http://xmlns.com/foaf/0.1/Person', null, 'http://vivoweb.org/ontology/core#hasMemberRole', 1, null, 'vivo:hasMemberRole', 'groups', 0, 0, null, '<Module ID="ApplyXSLT"><ParamList><Param Name="XSLTPath">~/profile/XSLT/MemberRoleOf.xslt</Param></ParamList></Module>', '<Module ID="CustomEditGroupMemberOf"/>', -20, -20, -40, -40, -40, -40, 1, 1, 0.1, 1, 1, -1 from [Ontology.].[ClassProperty]


update [Ontology.].[ClassProperty] set  IsDetail =  0 where Class= 'http://vivoweb.org/ontology/core#MemberRole' and  NetworkProperty is null and  Property= 'http://vivoweb.org/ontology/core#memberRoleOf'


insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://vivoweb.org/ontology/core#MemberRole', null, 'http://vivoweb.org/ontology/core#memberRoleOf', '[Profile.Data].[vwGroup.Member]', '-1', '-40', null, null, null, 0, '1', null, 'Person', 'PersonID', null, null, null, null, 'MemberRole', 'MemberRoleID', null, null, null, 'http://xmlns.com/foaf/0.1/Person' from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://vivoweb.org/ontology/core#MemberRole', null, 'http://vivoweb.org/ontology/core#roleContributesTo', '[Profile.Data].[vwGroup.Member]', '-1', '-40', null, null, null, 0, '1', null, 'Group', 'GroupID', null, null, null, null, 'MemberRole', 'MemberRoleID', null, null, null, 'http://xmlns.com/foaf/0.1/Group' from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://vivoweb.org/ontology/core#MemberRole', null, 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type', '[Profile.Data].[vwGroup.Member] x CROSS APPLY (select ''http://vivoweb.org/ontology/core#MemberRole'' TypeValue union all select ''http://vivoweb.org/ontology/core#Role'') t', '-1', '-40', null, null, null, 0, '1', 'TypeValue', null, null, 'TypeValue', null, null, null, 'MemberRole', 'MemberRoleID', null, null, null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://vivoweb.org/ontology/core#MemberRole', null, 'http://www.w3.org/2000/01/rdf-schema#label', '[Profile.Data].[vwGroup.Member]', '-1', '-40', null, null, null, 1, '1', null, null, null, 'Title', null, null, null, 'MemberRole', 'MemberRoleID', null, null, null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://vivoweb.org/ontology/core#MemberRole', null, null, '[Profile.Data].[vwGroup.Member]', 'ViewSecurityGroup', 'EditSecurityGroup', null, null, null, 0, '1', null, null, null, null, null, null, null, 'MemberRole', 'MemberRoleID', null, null, null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#associatedInformationResource', '[Profile.Data].[vwGroup.Publication.Entity.AssociatedInformationResource]', '-1', '-20', null, null, null, 0, '1', 'EntityDate desc', 'InformationResource', 'EntityID', null, null, null, null, 'Group', 'GroupID', null, null, null, 'http://vivoweb.org/ontology/core#InformationResource' from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://profiles.catalyst.harvard.edu/ontology/prns#hasGroupManager', '[Profile.Data].[vwGroup.Manager]', '-1', '-40', null, null, null, 0, '1', null, 'User', 'UserID', null, null, null, null, 'Group', 'GroupID', null, null, null, 'http://profiles.catalyst.harvard.edu/ontology/prns#User' from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://vivoweb.org/ontology/core#contributingRole', '[Profile.Data].[vwGroup.Member]', '-1', '-40', null, null, null, 0, '1', 'SortOrder', 'MemberRole', 'MemberRoleID', null, null, null, null, 'Group', 'GroupID', null, null, null, 'http://vivoweb.org/ontology/core#MemberRole' from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type', '[Profile.Data].[vwGroup.General] x CROSS APPLY (select ''http://xmlns.com/foaf/0.1/Group'' TypeValue union all select ''http://xmlns.com/foaf/0.1/Agent'') t', '-1', '-40', null, null, null, 0, '1', 'TypeValue', null, null, 'TypeValue', null, null, null, 'Group', 'GroupID', null, null, null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://xmlns.com/foaf/0.1/Group', null, 'http://www.w3.org/2000/01/rdf-schema#label', '[Profile.Data].[vwGroup.General]', '-1', '-40', null, null, null, 1, '1', null, null, null, 'GroupName', null, null, null, 'Group', 'GroupID', null, null, null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://xmlns.com/foaf/0.1/Group', null, null, '[Profile.Data].[vwGroup.General]', 'ViewSecurityGroup', 'EditSecurityGroup', null, null, null, 0, '1', null, null, null, null, null, null, null, 'Group', 'GroupID', null, null, null, null from [Ontology.].[DataMap]
insert into [Ontology.].[DataMap] ( DataMapID,DataMapGroup, IsAutoFeed, Graph, Class, NetworkProperty, Property, MapTable, ViewSecurityGroup, EditSecurityGroup, oStartDatePrecision, oEndDate, oEndDatePrecision, oObjectType, Weight, OrderBy, oInternalType, oInternalID, oValue, oDataType, oLanguage, oStartDate, sInternalType, sInternalID, cClass, cInternalType, cInternalID, oClass) 
select max(DataMapID) + 1, 1, 1, 1, 'http://xmlns.com/foaf/0.1/Person', null, 'http://vivoweb.org/ontology/core#hasMemberRole', '[Profile.Data].[vwGroup.Member]', '-1', '-40', null, null, null, 0, '1', null, 'MemberRole', 'MemberRoleID', null, null, null, null, 'Person', 'PersonID', null, null, null, 'http://vivoweb.org/ontology/core#MemberRole' from [Ontology.].[DataMap]



update [Ontology.].[PropertyGroup] set  SortOrder =  SortOrder + 1
insert into [Ontology.].[PropertyGroup] ( PropertyGroupURI, SortOrder, _PropertyGroupLabel) 
values ('http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupSettings', 1, 'Options')
update [Ontology.].[PropertyGroup] set  SortOrder =  SortOrder + 1 where SortOrder >= 3
insert into [Ontology.].[PropertyGroup] ( PropertyGroupURI, SortOrder, _PropertyGroupLabel) 
values ('http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupIntroduction', 3, 'Introduction')


delete from [Ontology.].[PropertyGroupProperty] where PropertyGroupURI= 'http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupOverview' and  PropertyURI= 'http://vivoweb.org/ontology/core#contactInformation'
insert into [Ontology.].[PropertyGroupProperty] ( PropertyGroupURI, PropertyURI, SortOrder, CustomDisplayModule, CustomEditModule) 
values ('http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupBibliographic', 'http://profiles.catalyst.harvard.edu/ontology/prns#associatedInformationResource', 9, null, null)
insert into [Ontology.].[PropertyGroupProperty] ( PropertyGroupURI, PropertyURI, SortOrder, CustomDisplayModule, CustomEditModule) 
values ('http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupIntroduction', 'http://profiles.catalyst.harvard.edu/ontology/prns#aboutUs', 2, null, null)
insert into [Ontology.].[PropertyGroupProperty] ( PropertyGroupURI, PropertyURI, SortOrder, CustomDisplayModule, CustomEditModule) 
values ('http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupIntroduction', 'http://profiles.catalyst.harvard.edu/ontology/prns#welcome', 1, null, null)
insert into [Ontology.].[PropertyGroupProperty] ( PropertyGroupURI, PropertyURI, SortOrder, CustomDisplayModule, CustomEditModule) 
values ('http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupIntroduction', 'http://vivoweb.org/ontology/core#contactInformation', 3, null, null)
insert into [Ontology.].[PropertyGroupProperty] ( PropertyGroupURI, PropertyURI, SortOrder, CustomDisplayModule, CustomEditModule) 
values ('http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupSettings', 'http://profiles.catalyst.harvard.edu/ontology/prns#hasGroupManager', 2, null, null)
insert into [Ontology.].[PropertyGroupProperty] ( PropertyGroupURI, PropertyURI, SortOrder, CustomDisplayModule, CustomEditModule) 
values ('http://profiles.catalyst.harvard.edu/ontology/prns#PropertyGroupSettings', 'http://profiles.catalyst.harvard.edu/ontology/prns#hasGroupSettings', 1, null, null)


insert into [Ontology.Presentation].[XML] ( PresentationID,Type, Subject, Predicate, Object, PresentationXML) 
select max(PresentationID) + 1, 'N', 'http://xmlns.com/foaf/0.1/Group', 'http://vivoweb.org/ontology/core#contributingRole', null, '<Presentation PresentationClass="profile"><PageOptions Columns="2"/><WindowName>{{{rdf:RDF[1]/rdf:Description[1]/rdfs:label[1]}}}</WindowName><PageColumns>2</PageColumns><PageTitle>{{{rdf:RDF[1]/rdf:Description[1]/rdfs:label[1]}}}</PageTitle><PageBackLinkName>Back to Group Profile</PageBackLinkName><PageBackLinkURL>{{{//rdf:RDF/rdf:Description/rdf:subject/@rdf:resource}}}</PageBackLinkURL><PageSubTitle>Group Members</PageSubTitle><PageDescription/><PanelTabType>Fixed</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"/></Panel><Panel Type="main" TabSort="1" TabType="Default" Alias="byname" Name="By Name"><Module ID="ApplyXSLT"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="XSLTPath">~/profile/XSLT/ContributingRoleDetails.xslt</Param></ParamList></Module></Panel><Panel Type="main" TabSort="2" Alias="byrole" Name="By Role"><Module ID="ApplyXSLT"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="XSLTPath">~/profile/XSLT/ContributingRoleRoles.xslt</Param></ParamList></Module></Panel><Panel Type="main" TabSort="3" Alias="map" Name="Map" DisplayRule="rdf:RDF/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/prns:latitude"><Module ID="NetworkMap"><ParamList><Param Name="MapType">Group</Param></ParamList></Module></Panel><Panel Type="main" TabSort="4" Alias="coauthors" Name="Co-Authors"><Module ID="NetworkClusterGroup"/></Panel></PanelList></Presentation>' from [Ontology.Presentation].[XML]
insert into [Ontology.Presentation].[XML] ( PresentationID,Type, Subject, Predicate, Object, PresentationXML) 
select max(PresentationID) + 1, 'P', 'http://xmlns.com/foaf/0.1/Group', null, null, '<Presentation PresentationClass="profile"><PageOptions Columns="3"/><WindowName>{{{rdf:RDF[1]/rdf:Description[1]/rdfs:label[1]}}}</WindowName><PageColumns>3</PageColumns><PageTitle>{{{rdf:RDF[1]/rdf:Description[1]/rdfs:label[1]}}}</PageTitle><PageBackLinkName/><PageBackLinkURL/><PageSubTitle/><PageDescription/><PanelTabType>Fixed</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"/></Panel><Panel Type="main" TabSort="0" TabType="Default"><Module ID="CustomViewGroupGeneralInfo"/><Module ID="PropertyList"><ParamList/></Module></Panel><Panel Type="passive"><Module ID="PassiveList"><ParamList><Param Name="InfoCaption">Group Members</Param><Param Name="Description">Members of this Group.</Param><Param Name="MaxDisplay">20</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/vivo:contributingRole/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/vivo:memberRoleOf[1]/@rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/vivo:memberRoleOf[1]/@rdf:resource}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#contributingRole"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#contributingRole"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module></Panel></PanelList><ExpandRDFList><ExpandRDF Class="http://xmlns.com/foaf/0.1/Group" Property="http://profiles.catalyst.harvard.edu/ontology/prns#associatedInformationResource" Limit="1" /></ExpandRDFList></Presentation>' from [Ontology.Presentation].[XML]
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="network"><PageOptions Columns="3"/><WindowName>{{{//rdf:RDF/rdf:Description[@rdf:about= ../rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{//rdf:RDF/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}''s research topics</WindowName><PageColumns>3</PageColumns><PageTitle>{{{//rdf:RDF/rdf:Description[@rdf:about= ../rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{//rdf:RDF/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}</PageTitle><PageBackLinkName>Back to Profile</PageBackLinkName><PageBackLinkURL>{{{//rdf:RDF/rdf:Description/rdf:subject/@rdf:resource}}}</PageBackLinkURL><PageSubTitle>Concepts  ({{{//rdf:RDF/rdf:Description/prns:numberOfConnections}}})</PageSubTitle><PageDescription>Concepts are derived automatically from a person''s publications.</PageDescription><PanelTabType>Default</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"/></Panel><Panel Type="main" TabSort="0" TabType="Default" Alias="cloud" Name="Cloud"><Module ID="NetworkList"><ParamList><Param Name="Cloud">true</Param></ParamList></Module><!--<Module ID="NetworkList">
        <ParamList>
          <Param Name="DataURI">rdf:RDF/rdf:Description[1]/@rdf:about</Param>
          <Param Name="InfoCaption">In this concept ''cloud'', the sizes of the concepts are based not only on the number of corresponding publications, but also how relevant the concepts are to the overall topics of the publications, how long ago the publications were written, whether the person was the first or senior author, and how many other people have written about the same topic. The largest concepts are those that are most unique to this person.</Param>
          <Param Name="BulletType" />
          <Param Name="Columns">2</Param>
          <Param Name="NetworkListNode">rdf:RDF/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasConnection/@rdf:resource]</Param>
          <Param Name="CloudWeightNode">prns:connectionWeight</Param>
          <Param Name="ItemURLText">{{{rdf:Description[1]/rdf:object/@rdf:resource}}}</Param>
          <Param Name="ItemText" />
          <Param Name="ItemURL">{{{rdf:Description[1]/rdf:object/@rdf:resource}}}</Param>
        </ParamList>
      </Module>--></Panel><Panel Type="main" TabSort="1" Alias="categories" Name="Categories"><Module ID="NetworkCategories"><ParamList><Param Name="InfoCaption">Concepts listed here are grouped according to their ''semantic'' categories. Within each category, up to ten concepts are shown, in decreasing order of relevance.</Param><Param Name="NetworkListNode">rdf:RDF/rdf:Description[@rdf:about= //rdf:RDF/rdf:Description/prns:hasConnection/@rdf:resource]</Param><Param Name="CategoryPath">//prns:meshSemanticGroupName</Param><Param Name="ItemText">{{{//rdf:Description/rdfs:label}}}</Param><Param Name="ItemURL">{{{//rdf:Description/@rdf:about}}}</Param></ParamList></Module></Panel><Panel Type="main" TabSort="2" Alias="timeline" Name="Timeline"><Module ID="NetworkTimeline"><ParamList><Param Name="TimelineType">Concept</Param><Param Name="InfoCaption">The timeline below shows the dates (blue tick marks) of publications associated with @SubjectName''s top concepts. The average publication date for each concept is shown as a red circle, illustrating changes in the primary topics that @SubjectName has written about over time.</Param></ParamList></Module></Panel><Panel Type="main" TabSort="3" Alias="details" Name="Details"><Module ID="ApplyXSLT"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="XSLTPath">~/profile/XSLT/ConceptDetail.xslt</Param></ParamList></Module></Panel><Panel Type="passive"><Module ID="PassiveHeader"/><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Concepts</Param><Param Name="Description">Derived automatically from this person''s publications.</Param><Param Name="MaxDisplay">5</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/vivo:hasResearchArea/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) concept(s)</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Co-Authors</Param><Param Name="MaxDisplay">5</Param><Param Name="Description">People in Profiles who have published with this person.</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:coAuthorOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Similar People</Param><Param Name="Description">People who share similar concepts with this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:similarTo/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="CustomViewPersonSameDepartment"/><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Physical Neighbors</Param><Param Name="Description">People whose addresses are nearby this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:physicalNeighborOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param></ParamList></Module></Panel></PanelList></Presentation>' where Type= 'N' and  Subject= 'http://xmlns.com/foaf/0.1/Person' and  Predicate= 'http://vivoweb.org/ontology/core#hasResearchArea' and  Object is null
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="network"><PageOptions Columns="3"/><WindowName>{{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}''s co-authors</WindowName><PageColumns>3</PageColumns><PageTitle>{{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}</PageTitle><PageBackLinkName>Back to Profile</PageBackLinkName><PageBackLinkURL>{{{//rdf:RDF/rdf:Description/rdf:subject/@rdf:resource}}}</PageBackLinkURL><PageSubTitle>Co-Authors ({{{//rdf:RDF/rdf:Description/prns:numberOfConnections}}})</PageSubTitle><PageDescription>Co-Authors are people in Profiles who have published together.</PageDescription><PanelTabType>Default</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"/></Panel><Panel Type="main" TabSort="0" TabType="Default" Alias="list" Name="List"><Module ID="NetworkList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="BulletType">disc</Param><Param Name="Columns">2</Param><Param Name="NetworkListNode">rdf:RDF/rdf:Description[@rdf:about= ../rdf:Description[1]/prns:hasConnection/@rdf:resource]</Param><Param Name="ItemURLText">{{{rdf:Description/rdf:object/@rdf:resource}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/rdf:object/@rdf:resource}}}</Param></ParamList></Module></Panel><Panel Type="main" TabSort="1" Alias="map" Name="Map" DisplayRule="rdf:RDF/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/prns:latitude"><Module ID="NetworkMap"><ParamList><Param Name="MapType">CoAuthor</Param></ParamList></Module></Panel><Panel Type="main" TabSort="2" Alias="radial" Name="Radial"><Module ID="NetworkRadial"/></Panel><Panel Type="main" TabSort="3" Alias="cluster" Name="Cluster"><Module ID="NetworkCluster"/></Panel><Panel Type="main" TabSort="4" Alias="timeline" Name="Timeline"><Module ID="NetworkTimeline"><ParamList><Param Name="TimelineType">CoAuthor</Param><Param Name="InfoCaption">The timeline below shows the dates (blue tick marks) of publications @SubjectName co-authored with other people in Profiles. The average publication date for each co-author is shown as a red circle, illustrating changes in the people that @SubjectName has worked with over time.</Param></ParamList></Module></Panel><Panel Type="main" TabSort="5" Alias="details" Name="Details"><Module ID="ApplyXSLT"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="XSLTPath">~/profile/XSLT/CoAuthorDetail.xslt</Param></ParamList></Module></Panel><Panel Type="passive"><Module ID="PassiveHeader"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Concepts</Param><Param Name="Description">Derived automatically from this person''s publications.</Param><Param Name="MaxDisplay">5</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/vivo:hasResearchArea/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) concept(s)</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Co-Authors</Param><Param Name="MaxDisplay">5</Param><Param Name="Description">People in Profiles who have published with this person.</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:coAuthorOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Similar People</Param><Param Name="Description">People who share similar concepts with this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:similarTo/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="CustomViewPersonSameDepartment"/><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Physical Neighbors</Param><Param Name="Description">People whose addresses are nearby this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:physicalNeighborOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param></ParamList></Module></Panel></PanelList></Presentation>' where Type= 'N' and  Subject= 'http://xmlns.com/foaf/0.1/Person' and  Predicate= 'http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf' and  Object is null
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="network"><PageOptions Columns="3"/><WindowName>{{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}''s related authors</WindowName><PageColumns>3</PageColumns><PageTitle>{{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:firstName}}} {{{rdf:RDF[1]/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/foaf:lastName}}}</PageTitle><PageBackLinkName>Back to Profile</PageBackLinkName><PageBackLinkURL>{{{//rdf:RDF/rdf:Description/rdf:subject/@rdf:resource}}}</PageBackLinkURL><PageSubTitle>Similar People ({{{//rdf:RDF/rdf:Description/prns:numberOfConnections}}})</PageSubTitle><PageDescription>Similar people share similar sets of concepts, but are not necessarily co-authors.</PageDescription><PanelTabType>Default</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"/></Panel><Panel Type="main" TabSort="0" TabType="Default" Alias="list" Name="List"><Module ID="NetworkList"><ParamList><Param Name="InfoCaption">The people in this list are ordered by decreasing similarity.     (<font color="red">*</font> These people are also co-authors.)</Param><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="BulletType">disc</Param><Param Name="Columns">2</Param><Param Name="NetworkListNode">rdf:RDF/rdf:Description[@rdf:about= ../rdf:Description[1]/prns:hasConnection/@rdf:resource]</Param><Param Name="ItemURLText">{{{rdf:Description/rdf:object/@rdf:resource}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/rdf:object/@rdf:resource}}}</Param><Param Name="SortBy">Weight</Param></ParamList></Module></Panel><Panel Type="main" TabSort="1" Alias="map" Name="Map" DisplayRule="rdf:RDF/rdf:Description[@rdf:about= /rdf:RDF[1]/rdf:Description[1]/rdf:subject/@rdf:resource]/prns:latitude"><Module ID="NetworkMap"><ParamList><Param Name="MapType">SimilarTo</Param></ParamList></Module></Panel><Panel Type="main" TabSort="3" Alias="details" Name="Details"><Module ID="ApplyXSLT"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/@rdf:about</Param><Param Name="XSLTPath">~/profile/XSLT/SimilarPeopleDetail.xslt</Param></ParamList></Module></Panel><Panel Type="passive"><Module ID="PassiveHeader"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Concepts</Param><Param Name="Description">Derived automatically from this person''s publications.</Param><Param Name="MaxDisplay">5</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/vivo:hasResearchArea/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) concept(s)</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Co-Authors</Param><Param Name="MaxDisplay">5</Param><Param Name="Description">People in Profiles who have published with this person.</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:coAuthorOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Similar People</Param><Param Name="Description">People who share similar concepts with this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:similarTo/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="CustomViewPersonSameDepartment"/><Module ID="PassiveList"><ParamList><Param Name="DataURI">rdf:RDF/rdf:Description/rdf:subject/@rdf:resource</Param><Param Name="ExpandRDFList"><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></Param><Param Name="InfoCaption">Physical Neighbors</Param><Param Name="Description">People whose addresses are nearby this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:physicalNeighborOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param></ParamList></Module></Panel></PanelList></Presentation>' where Type= 'N' and  Subject= 'http://xmlns.com/foaf/0.1/Person' and  Predicate= 'http://profiles.catalyst.harvard.edu/ontology/prns#similarTo' and  Object is null
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="profile"><PageOptions Columns="3"/><WindowName>{{{rdf:RDF[1]/rdf:Description[1]/foaf:firstName[1]}}} {{{rdf:RDF[1]/rdf:Description[1]/foaf:lastName[1]}}}</WindowName><PageColumns>3</PageColumns><PageTitle>{{{rdf:RDF[1]/rdf:Description[1]/prns:fullName[1]}}}</PageTitle><PageBackLinkName/><PageBackLinkURL/><PageSubTitle/><PageDescription/><PanelTabType>Fixed</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"/></Panel><Panel Type="main" TabType="Fixed"><Module ID="CustomViewPersonGeneralInfo"/><Module ID="ApplyXSLT"><ParamList><Param Name="XSLTPath">~/profile/XSLT/OtherPositions.xslt</Param></ParamList></Module><Module ID="PropertyList"><ParamList/></Module><Module ID="HRFooter"/></Panel><Panel Type="passive"><Module ID="PassiveHeader"><ParamList><Param Name="DisplayRule">rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections</Param><Param Name="DisplayRule">rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections</Param><Param Name="DisplayRule">rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="InfoCaption">Concepts</Param><Param Name="Description">Derived automatically from this person''s publications.</Param><Param Name="MaxDisplay">5</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/vivo:hasResearchArea/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://vivoweb.org/ontology/core#hasResearchArea"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) concept(s)</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="InfoCaption">Co-Authors</Param><Param Name="MaxDisplay">5</Param><Param Name="Description">People in Profiles who have published with this person.</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:coAuthorOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#coAuthorOf"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="InfoCaption">Similar People</Param><Param Name="Description">People who share similar concepts with this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/prns:similarTo/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">{{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/@rdf:about}}}</Param><Param Name="MoreText">See all ({{{rdf:RDF/rdf:Description[rdf:predicate/@rdf:resource="http://profiles.catalyst.harvard.edu/ontology/prns#similarTo"][@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:hasNetwork/@rdf:resource]/prns:numberOfConnections}}}) people</Param></ParamList></Module><Module ID="CustomViewPersonSameDepartment"/><Module ID="Gadgets"><ParamList><Param Name="HTML"><div id="gadgets-tools" class="gadgets-gadget-parent"/></Param></ParamList></Module><Module ID="PassiveList"><ParamList><Param Name="InfoCaption">Physical Neighbors</Param><Param Name="Description">People whose addresses are nearby this person.</Param><Param Name="MaxDisplay">11</Param><Param Name="ListNode">@rdf:about= /rdf:RDF[1]/rdf:Description[1]/prns:physicalNeighborOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param></ParamList></Module></Panel></PanelList><ExpandRDFList><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#authorInAuthorship" Limit="1"/><ExpandRDF Class="http://xmlns.com/foaf/0.1/Person" Property="http://vivoweb.org/ontology/core#hasResearcherRole" Limit="1"/></ExpandRDFList></Presentation>' where Type= 'P' and  Subject= 'http://xmlns.com/foaf/0.1/Person' and  Predicate is null and  Object is null
update [Ontology.Presentation].[XML] set  PresentationXML =  '<Presentation PresentationClass="profile"><PageOptions Columns="3"/><WindowName>{{{rdf:RDF[1]/rdf:Description[1]/rdfs:label[1]}}}</WindowName><PageColumns>3</PageColumns><PageTitle>{{{rdf:RDF[1]/rdf:Description[1]/rdfs:label[1]}}}</PageTitle><PageBackLinkName/><PageBackLinkURL/><PageSubTitle/><PageDescription/><PanelTabType>Fixed</PanelTabType><PanelList><Panel Type="active"><Module ID="MiniSearch"/><Module ID="MainMenu"/></Panel><Panel Type="main" TabSort="0" TabType="Default"><Module ID="CustomViewConceptMeshInfo"><ParamList/></Module></Panel><Panel Type="main" TabSort="0" TabType="Default"><Module ID="CustomViewConceptPublication"><ParamList><Param Name="TimelineCaption">This graph shows the total number of publications written about "@ConceptName" by people in this website by year, and whether "@ConceptName" was a major or minor topic of these publications. &lt;!--In all years combined, a total of [[[TODO:PUBLICATION COUNT]]] publications were written by people in Profiles.--&gt;</Param><Param Name="CitedCaption">Below are the publications written about "@ConceptName" that have been cited the most by articles in Pubmed Central.</Param><Param Name="NewestCaption">Below are the most recent publications written about "@ConceptName" by people in Profiles.</Param><Param Name="OldestCaption">Below are the earliest publications written about "@ConceptName" by people in Profiles.</Param></ParamList></Module></Panel><Panel Type="passive"><Module ID="PassiveList"><ParamList><Param Name="InfoCaption">People</Param><Param Name="Description">People who have written about this concept.</Param><Param Name="MaxDisplay">5</Param><Param Name="ListNode">/rdf:RDF[1]/rdf:Description[1]/vivo:researchAreaOf/@rdf:resource</Param><Param Name="ItemURLText">{{{rdf:Description/rdfs:label}}}</Param><Param Name="ItemText"/><Param Name="ItemURL">{{{rdf:Description/@rdf:about}}}</Param><Param Name="MoreURL">/search/default.aspx?searchtype=people&amp;searchfor={{{rdf:RDF/rdf:Description/rdfs:label}}}&amp;classuri=http://xmlns.com/foaf/0.1/Person&amp;erpage=15&amp;offset=0&amp;exactPhrase=true</Param><Param Name="MoreText">See all people</Param></ParamList></Module><Module ID="CustomViewConceptSimilarMesh"><ParamList><Param Name="InfoCaption">Similar Concepts</Param><Param Name="Description">People who have written about this concept.</Param></ParamList></Module><Module ID="CustomViewConceptTopJournal"><ParamList><Param Name="InfoCaption">Top Journals</Param><Param Name="Description">Top journals in which articles about this concept have been published.</Param></ParamList></Module></Panel></PanelList></Presentation>' where Type= 'P' and  Subject= 'http://www.w3.org/2004/02/skos/core#Concept' and  Predicate is null and  Object is null

insert into [Framework.].[Job] ( JobID,JobGroup, Script, IsActive, Step)   select max(JobID) + 1, 7, 'UPDATE [Profile.Data].[Group.General] SET ViewSecurityGroup = 0 WHERE EndDate < GETDATE()', 1, 15 from [Framework.].[Job]


--*****************************************************************************************
--*****************************************************************************************
--*****************************************************************************************
--*****
--***** Finalize changes
--*****
--*****************************************************************************************
--*****************************************************************************************
--*****************************************************************************************

  -- Update all derived fields
EXEC [Ontology.].[UpdateDerivedFields]
EXEC [Ontology.].[UpdateCounts]
EXEC [Ontology.].CleanUp @action='UpdateIDs'

-- Update the RDF tables and cache
EXEC [Framework.].[RunJobGroup] @JobGroup = 3
 
GO